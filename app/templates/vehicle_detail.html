{% extends 'base.html' %}
{% block title %}Vehicle #{{ vehicle.unit_no or vehicle.id }}{% endblock %}

{% block content %}
<div class="container my-4">
  <h1 class="mb-4">Vehicle Profile: {{ vehicle.make }} {{ vehicle.model }} ({{ vehicle.unit_no or 'No Unit #' }})</h1>

  <!-- ── Nav Tabs ─────────────────────────────────────────────── -->
  <ul class="nav nav-tabs" id="vehicleTabs" role="tablist">
    <li class="nav-item" role="presentation">
      <button class="nav-link active" id="overview-tab" data-bs-toggle="tab" data-bs-target="#overview" type="button" role="tab">Overview</button>
    </li>
    <li class="nav-item" role="presentation">
      <button class="nav-link" id="maintenance-tab" data-bs-toggle="tab" data-bs-target="#maintenance" type="button" role="tab">Maintenance</button>
    </li>
    <li class="nav-item" role="presentation">
      <button class="nav-link" id="workorders-tab" data-bs-toggle="tab" data-bs-target="#workorders" type="button" role="tab">Work Orders</button>
    </li>
    <li class="nav-item" role="presentation">
      <button class="nav-link" id="fuel-tab" data-bs-toggle="tab" data-bs-target="#fuel" type="button" role="tab">Fuel Logs</button>
    </li>
    <li class="nav-item" role="presentation">
      <button class="nav-link" id="docs-tab" data-bs-toggle="tab" data-bs-target="#docs" type="button" role="tab">Documents</button>
    </li>
  </ul>

  <!-- ── Tab Content ───────────────────────────────────────────── -->
  <div class="tab-content border p-4 bg-white" id="vehicleTabContent">

    <!-- Overview Tab -->
    <div class="tab-pane fade show active" id="overview" role="tabpanel">
      <div class="row g-3">
        <div class="col-md-4">
          <strong>VIN:</strong> {{ vehicle.vin }}<br>
          <strong>Year:</strong> {{ vehicle.year }}<br>
          <strong>Make:</strong> {{ vehicle.make }}<br>
          <strong>Model:</strong> {{ vehicle.model }}<br>
          <strong>Unit No:</strong> {{ vehicle.unit_no }}<br>
          <strong>Body:</strong> {{ vehicle.body }}<br>
          <strong>Type:</strong> {{ vehicle.type }}
        </div>
        <div class="col-md-4">
          <strong>Odometer:</strong> {{ vehicle.odometer }}<br>
          <strong>Hours:</strong> {{ vehicle.hours }}<br>
          <strong>Chargeback:</strong> {{ vehicle.chargeback }}<br>
          <strong>Department:</strong> {{ vehicle.department }}<br>
          <strong>Manager:</strong> {{ vehicle.manager }}<br>
          <strong>Director:</strong> {{ vehicle.director }}
        </div>
        <div class="col-md-4">
          <strong>Location:</strong> {{ vehicle.location }}<br>
          <strong>Building:</strong> {{ vehicle.building }}<br>
          <strong>Registration Exp:</strong> {{ vehicle.registration_exp }}<br>
          <strong>Inspection Exp:</strong> {{ vehicle.inspection_exp }}<br>
          <strong>Insurance Exp:</strong> {{ vehicle.insurance_exp }}<br>
        </div>
      </div>
      <div class="mt-4">
        <a href="{{ url_for('main.edit_vehicle', vehicle_id=vehicle.id) }}" class="btn btn-primary">Edit Vehicle</a>
      </div>
    </div>

    <!-- Maintenance Tab -->
    <div class="tab-pane fade" id="maintenance" role="tabpanel">
      <div class="d-flex justify-content-between align-items-center mb-3">
        <h5>Maintenance Logs</h5>
        <a href="{{ url_for('main.add_maintenance', vehicle_id=vehicle.id) }}" class="btn btn-sm btn-success">+ Add Maintenance</a>
      </div>
      {% if vehicle.maintenance_logs %}
        <ul class="list-group">
          {% for log in vehicle.maintenance_logs %}
            <li class="list-group-item">
              {{ log.date }} - {{ log.description }} ({{ log.cost }} USD)
            </li>
          {% endfor %}
        </ul>
      {% else %}
        <p>No maintenance records.</p>
      {% endif %}
    </div>

    <!-- Work Orders Tab -->
    <div class="tab-pane fade" id="workorders" role="tabpanel">
      <div class="d-flex justify-content-between align-items-center mb-3">
        <h5>Work Orders</h5>
        <a href="{{ url_for('main.add_work_order', vehicle_id=vehicle.id) }}" class="btn btn-sm btn-success">+ Add Work Order</a>
      </div>
      <p>Work order table goes here…</p>
    </div>

    <!-- Fuel Logs Tab -->
    <div class="tab-pane fade" id="fuel" role="tabpanel">
      <div class="d-flex justify-content-between align-items-center mb-3">
        <h5>Fuel Logs</h5>
        <a href="{{ url_for('main.add_fuel_log', vehicle_id=vehicle.id) }}" class="btn btn-sm btn-success">+ Add Fuel Log</a>
      </div>
      {% if vehicle.fuel_logs %}
        <ul class="list-group">
          {% for fuel in vehicle.fuel_logs %}
            <li class="list-group-item">
              {{ fuel.date }} - {{ fuel.gallons }} gal @ ${{ fuel.price_per_gallon }} (MPG: {{ fuel.mpg }})
            </li>
          {% endfor %}
        </ul>
      {% else %}
        <p>No fuel records.</p>
      {% endif %}
    </div>

    <!-- Documents Tab -->
    <div class="tab-pane fade" id="docs" role="tabpanel">
      <div class="row">
        <div class="col-md-6">
          <h6>Photo</h6>
          {% if vehicle.photo_filename %}
            <img src="{{ url_for('static', filename='uploads/' ~ vehicle.photo_filename) }}" class="img-fluid rounded border">
          {% else %}
            <p>No photo uploaded.</p>
          {% endif %}
        </div>
        <div class="col-md-6">
          <h6>Invoice</h6>
          {% if vehicle.invoice_filename %}
            <a href="{{ url_for('static', filename='uploads/' ~ vehicle.invoice_filename) }}" target="_blank" class="btn btn-outline-primary">View Invoice</a>
          {% else %}
            <p>No invoice uploaded.</p>
          {% endif %}
        </div>
      </div>
    </div>

  </div>
</div>
{% endblock %}
